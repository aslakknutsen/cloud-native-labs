schemaVersion: 2.0.0
metadata:
  name: wksp-debugging
workspace:
  defaultEnv: default
  environments:
    default:
      machines:
        dev-machine:
          attributes:
            memoryLimitBytes: '4294967296'
          servers: {}
          volumes: {}
          installers:
          - org.eclipse.che.exec
          - org.eclipse.che.terminal
          - org.eclipse.che.ws-agent
          - org.eclipse.che.ls.java
          env:
            MAVEN_OPTS: "-Xmx512m"
            MAVEN_MIRROR_URL: http://nexus.opentlc-shared.svc:8081/repository/maven-all-public
            OPENSHIFT_API_URL: https://api.cluster-3ea4.3ea4.events.opentlc.com
      recipe:
        type: dockerimage
        content: image-registry.openshift-image-registry.svc:5000/openshift/che-cloud-native:ocp4
projects:
- name: labs
  zip:
    location: https://github.com/mcouliba/cloud-native-labs/archive/debugging.zip
  attributes:
    skipFirstLevel: 'true'
commands:
- id: oclogin
  exec:
    commandLine: |-
      username=${workspace.namespace}
      projectname=coolstore${username#user}
      oc login ${OPENSHIFT_API_URL} -u ${username} -p 'openshift' --insecure-skip-tls-verify
      oc project ${projectname}
      echo "-----------"
      echo "Successful Connected to OpenShift as ${username}"
      echo "-----------"
    label: oc login
    component: custom
  attributes:
    goal: OpenShift
